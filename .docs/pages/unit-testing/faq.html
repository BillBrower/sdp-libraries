

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>FAQ &mdash; SDP Pipeline Libraries  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../../',
              VERSION:'',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/theme_overrides.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/style.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/banner.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="prev" title="Test Execution" href="executing-tests.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> SDP Pipeline Libraries
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Libraries</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../a11y/README.html">The A11y Machine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docker/README.html">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../github/README.html">GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../github_enterprise/README.html">GitHub Enterprise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../openshift/README.html">OpenShift</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../owasp_dep_check/README.html">OWASP Dependency Check</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../owasp_zap/README.html">OWASP ZAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../protractor/README.html">Protractor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sdp/README.html">SDP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../slack/README.html">Slack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sonarqube/README.html">SonarQube</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../twistlock/README.html">Twistlock</a></li>
</ul>
<p class="caption"><span class="caption-text">Resources</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Unit Testing</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="jenkins-spock.html">Jenkins Spock</a></li>
<li class="toctree-l2"><a class="reference internal" href="writing-tests.html">Writing Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="executing-tests.html">Test Execution</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">FAQ</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">SDP Pipeline Libraries</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Unit Testing</a> &raquo;</li>
        
      <li>FAQ</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/.docs/pages/unit-testing/faq.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  





<div class="section" id="faq">
<span id="id1"></span><h1>FAQ<a class="headerlink" href="#faq" title="Permalink to this headline">¶</a></h1>
<p>This section covers some of the questions not easily answered in the Spock or
Jenkins-Spock documentation.</p>
<p><hr></p>
<p><strong>Q: What’s the difference between explicitlyMockPipelineStep and explicitlyMockPipelineVariable?</strong></p>
<p><strong>A: Practically speaking, the difference is you can omit “.call” for explicitlyMockPipelineStep() when you use getPipelineMock()</strong></p>
<p>In the example above, I used <code class="docutils literal"><span class="pre">explicitlyMockPipelineStep()</span></code> to mock <code class="docutils literal"><span class="pre">error</span></code>.
Because of that, if I want to see if the <code class="docutils literal"><span class="pre">error</span></code> pipeline step is run, I use
<code class="docutils literal"><span class="pre">1</span> <span class="pre">*</span> <span class="pre">getPipelineMock(&quot;error&quot;)</span></code>. If I were to create the mock using
<code class="docutils literal"><span class="pre">explicitlyMockPipelineVariable()</span></code> I would instead use <code class="docutils literal"><span class="pre">1</span> <span class="pre">*</span> <span class="pre">getPipelineMock(&quot;error.call&quot;)</span></code></p>
<p>There may be some additional differences as well, so try to use what makes the most sense</p>
<p><hr></p>
<p><strong>Q: What if I don’t know exactly what the parameters are going to be?</strong></p>
<p><strong>A: There are ways to match parameters to regex expressions, as well as test
parameters individually</strong></p>
<p>The standard format for interaction-based tests are</p>
<div class="highlight-groovy"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">count</span><span class="o">&gt;</span> <span class="o">*</span> <span class="n">getPipelineMock</span><span class="o">(&lt;</span><span class="n">method</span><span class="o">&gt;)(&lt;</span><span class="n">parameter</span><span class="o">(</span><span class="n">s</span><span class="o">)&gt;)</span>
</pre></div>
</div>
<p>While you can put the exact parameter value in the second parentheses, you can
also run arbitrary groovy code inside curly brackets. Whether or not it’s a “match”
depends on if that code returns <code class="docutils literal"><span class="pre">true</span></code> or <code class="docutils literal"><span class="pre">false</span></code>. A good example is in
PenetrationTestSpec.groovy. Use <code class="docutils literal"><span class="pre">it</span></code> to get the value of the parameter.
<code class="docutils literal"><span class="pre">`1</span> <span class="pre">*</span> <span class="pre">getPipelineMock(&quot;sh&quot;)({it</span> <span class="pre">=~</span> <span class="pre">/</span> <span class="pre">(zap-cli</span> <span class="pre">open-url)</span> <span class="pre">Kirk</span> <span class="pre">(.+)/})`</span></code></p>
<p><hr></p>
<p><strong>Q: Do I have to do interaction-based testing?</strong></p>
<p><strong>A: No, but you can’t get variables the same way as traditional Spock tests</strong></p>
<p>This is because the script gets run in that <code class="docutils literal"><span class="pre">loadPipelineScriptForTest</span></code> object.
You can only access variables stored in the binding, which are few. It makes more
sense to see how variables are being used in pipeline steps, and make sure those
pipeline steps use the correct value for those variables.</p>
<p>Similarly, if you need to control how a variable is set, you need to stub whatever
method or pipeline step that sets the initial value for that variable</p>
<p>As an example, in PenetrationTestSpec.groovy, the <code class="docutils literal"><span class="pre">target</span></code> variable in
penetration_test.groovy is tested by checking the parameters to an <code class="docutils literal"><span class="pre">sh</span></code> step.</p>
<p><hr></p>
<p><strong>Q: I keep getting “can’t run method foo() on null; what do I do?”</strong></p>
<p><strong>A: You need to find a way to stub the method that sets the value for the object that calls foo()</strong></p>
<p>There should be an example in GetImagesToBuildSpec.groovy (in the docker-unit-tests
branch at the time of writing)</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="executing-tests.html" class="btn btn-neutral float-left" title="Test Execution" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Booz Allen Hamilton

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: master
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Tags</dt>
            <dd><a href="../../../jenkins-test/index.html">jenkins-test</a></dd>
            <dd><a href="../../../v1.0/index.html">v1.0</a></dd>
        </dl>
        <dl>
            <dt>Branches</dt>
            <dd><a href="../../../master/.docs/pages/unit-testing/faq.html">master</a></dd>
        </dl>
    </div>
</div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>